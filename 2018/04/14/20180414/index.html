<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>Java中只有值传递 - rivers &amp; lakes</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/image/stef.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="/image/page_background.jpg"><div class="post-title"><h1 class="title">Java中只有值传递</h1><ul class="meta"><li><i class="icon icon-author"></i>jiawei</li><li><i class="icon icon-clock"></i>12 Minutes</li><li><i class="icon icon-calendar"></i>April 14, 2018</li></ul></div></div><div class="article-content" style="max-width:800px"><p><br><font color="#ff0044" size="3.5" face="Times New Roman">Java中只有值传递</font><br></p><br>—————-<br><font color="#000000" size="3.5" face="MV Boli">jiawei</font><br><a id="more"></a><br><br><font color="#ff0044" size="3.5" face="Times New Roman"><br>错误理解一：值传递和引用传递，区分的条件是传递的内容，如果是个值，就是值传递。如果是个引用，就是引用传递。<br>错误理解二：Java是引用传递。<br>错误理解三：传递的参数如果是普通类型，那就是值传递，如果是对象，那就是引用传递。<br></font><br><br>实参与形参<br>我们都知道，在Java中定义方法的时候是可以定义参数的。比如Java中的main方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args)</span><br></pre></td></tr></table></figure><br><br>这里面的args就是参数。参数在程序语言中分为形式参数和实际参数。<br>形式参数：是在定义函数名和函数体的时候使用的参数,目的是用来接收调用该函数时传入的参数。<br>实际参数：在调用有参函数时，主调函数和被调函数之间有数据传递关系。在主调函数中调用一个函数时，函数名后面括号中的参数称为“实际参数”。<br>Eg：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">   ParamTest pt = new ParamTest();</span><br><span class="line">   pt.sout(&quot;stef&quot;);//实际参数为 stef</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void sout(String name) &#123; //形式参数为 name</span><br><span class="line">   System.out.println(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>实际参数是调用有参方法的时候真正传递的内容，而形式参数是用于接收实参内容的参数。<br>值传递与引用传递<br>当调用一个有参函数的时候，会把实际参数传递给形式参数。但是，在程序语言中，这个传递过程中传递的两种情况，即值传递和引用传递。我们来看下程序语言中是如何定义和区分值传递和引用传递的。<br>值传递（pass by value）是指在调用函数时将实际参数复制一份传递到函数中，这样在函数中如果对参数进行修改，将不会影响到实际参数。<br><br>引用传递（pass by reference）是指在调用函数时将实际参数的地址直接传递到函数中，那么在函数中对参数所进行的修改，将影响到实际参数。<br>就可以写代码实践了，看看Java中到底是值传递还是引用传递 ，简单的一段代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">   ParamTest pt = new ParamTest();</span><br><span class="line"></span><br><span class="line">   int i = 10;</span><br><span class="line">   pt.pass(i );</span><br><span class="line">   System.out.println(&quot;print in main , i is &quot; + i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void pass(int j) &#123;</span><br><span class="line">   j = 20;</span><br><span class="line">   System.out.println(&quot;print in pass , j is &quot; + j);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>上面的代码中，在pass方法中修改了参数j的值，然后分别在pass方法和main方法中打印参数的值。输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print in pass , j is 20</span><br><span class="line">print in main , i is 10</span><br></pre></td></tr></table></figure><br><br>可见，pass方法内部对name的值的修改并没有改变实际参数i的值。那么，按照上面的定义，有人得到结论：Java的方法传递是值传递。<br>但是，相反示例代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">   ParamTest pt = new ParamTest();</span><br><span class="line"></span><br><span class="line">   User stef = new User();</span><br><span class="line">   stef.setName(&quot;stef&quot;);</span><br><span class="line">   stef.setGender(&quot;Male&quot;);</span><br><span class="line">   pt.pass(stef);</span><br><span class="line">   System.out.println(&quot;print in main , user is &quot; + stef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void pass(User user) &#123;</span><br><span class="line">   user.setName(&quot;stef25&quot;);</span><br><span class="line">   System.out.println(&quot;print in pass , user is &quot; + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>同样是一个pass方法，同样是在pass方法内修改参数的值。输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print in pass , user is User&#123;name=&apos;stef25&apos;, gender=&apos;Male&apos;&#125;</span><br><span class="line">print in main , user is User&#123;name=&apos;stef25&apos;, gender=&apos;Male&apos;&#125;</span><br></pre></td></tr></table></figure><br><br>经过pass方法执行后，实参的值竟然被改变了，那按照上面的引用传递的定义，实际参数的值被改变了，这不就是引用传递了么。于是，根据上面的两段代码，得出一个新的结论：Java的方法中，在传递普通类型的时候是值传递，在传递对象类型的时候是引用传递。<br>但是，这种表述仍然是错误的。不信你看下面这个参数类型为对象的参数传递：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">   ParamTest pt = new ParamTest();</span><br><span class="line"></span><br><span class="line">   String name = &quot;stef&quot;;</span><br><span class="line">   pt.pass(name);</span><br><span class="line">   System.out.println(&quot;print in main , name is &quot; + name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void pass(String name) &#123;</span><br><span class="line">   name = &quot;stef25&quot;;</span><br><span class="line">   System.out.println(&quot;print in pass , name is &quot; + name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>上面的代码输出结果为:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print in pass , name is stef25</span><br><span class="line">print in main , name is stef</span><br></pre></td></tr></table></figure><br><br>这又作何解释呢？同样传递了一个对象，但是原始参数的值并没有被修改，难道传递对象又变成值传递了？<br>Java中的值传递<br>上面，举了三个例子，表现的结果却不一样，这也是导致很多初学者，甚至很多高级程序员对于Java的传递类型有困惑的原因。<br>其实，上面的概念没有错，只是代码的例子有问题。<br>概念中的重点:<br>值传递（pass by value）是指在调用函数时将实际参数复制一份传递到函数中，这样在函数中如果对参数进行修改，将不会影响到实际参数。<br>引用传递（pass by reference）是指在调用函数时将实际参数的地址直接传递到函数中，那么在函数中对参数所进行的修改，将影响到实际参数。<br>那么，我来给大家总结一下，值传递和引用传递之前的区别的重点是什么。<br><br>上面的几个pass的例子中，都只关注了实际参数内容是否有改变。如传递的是User对象，试着改变他的name属性的值，然后检查是否有改变。其实，在实验方法上就错了，当然得到的结论也就有问题了。<br>为什么说实验方法错了呢？这里来举一个形象的例子。再来深入理解一下值传递和引用传递，然后就知道为什么错了。<br>你有一把钥匙，当你的朋友想要去你家的时候，如果你直接把你的钥匙给他了，这就是引用传递。这种情况下，如果他对这把钥匙做了什么事情，比如他在钥匙上刻下了自己名字，那么这把钥匙还给你的时候，你自己的钥匙上也会多出他刻的名字。<br>你有一把钥匙，当你的朋友想要去你家的时候，你复刻了一把新钥匙给他，自己的还在自己手里，这就是值传递。这种情况下，他对这把钥匙做什么都不会影响你手里的这把钥匙。<br>但是，不管上面哪种情况，你的朋友拿着你给他的钥匙，进到你的家里，把你家的电视砸了。那你说你会不会受到影响？而在pass方法中，改变user对象的name属性的值的时候，不就是在“砸电视”么。你改变的不是那把钥匙，而是钥匙打开的房子。<br>还拿上面的一个例子来举例，我们真正的改变参数，看看会发生什么？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">   ParamTest pt = new ParamTest();</span><br><span class="line"></span><br><span class="line">   User stef = new User();</span><br><span class="line">   stef.setName(&quot;stef&quot;);</span><br><span class="line">   stef.setGender(&quot;Male&quot;);</span><br><span class="line">   pt.pass(stef);</span><br><span class="line">   System.out.println(&quot;print in main , user is &quot; + stef);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void pass(User user) &#123;</span><br><span class="line">   user = new User();</span><br><span class="line">   user.setName(&quot;stef25&quot;);</span><br><span class="line">   user.setGender(&quot;Male&quot;);</span><br><span class="line">   System.out.println(&quot;print in pass , user is &quot; + user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><br>上面的代码中，我们在pass方法中，改变了user对象，输出结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print in pass , user is User&#123;name=&apos;stef25&apos;, gender=&apos;Male&apos;&#125;</span><br><span class="line">print in main , user is User&#123;name=&apos;stef&apos;, gender=&apos;Male&apos;&#125;</span><br></pre></td></tr></table></figure><br><br>上面这种传递是什么传递？肯定不是引用传递，如果是引用传递的话，在执行user = new User();的时候，实际参数的引用也应该改为指向0X456789，但是实际上并没有。<br>通过概念我们也能知道，这里是把实际参数的引用的地址复制了一份，传递给了形式参数。所以，上面的参数其实是值传递，把实参对象引用的地址当做值传递给了形式参数。<br>我们再来回顾下之前的那个“砸电视”的例子，看那个例子中的传递过程发生了什么。<br><br>同样的，在参数传递的过程中，实际参数的地址0X1213456被拷贝给了形参，只是，在这个方法中，并没有对形参本身进行修改，而是修改的形参持有的地址中存储的内容。<br>所以，值传递和引用传递的区别并不是传递的内容。而是实参到底有没有被复制一份给形参。在判断实参内容有没有受影响的时候，要看传的的是什么，如果你传递的是个地址，那么就看这个地址的变化会不会有影响，而不是看地址指向的对象的变化。就像钥匙和房子的关系。<br>那么，既然这样，为啥上面同样是传递对象，传递的String对象和User对象的表现结果不一样呢？我们在pass方法中使用name = “stef25”;试着去更改name的值，阴差阳错的直接改变了name的引用的地址。因为这段代码，会new一个String，再把引用交给name，即等价于：<br>name = new String(“stef25”);<br>而原来的那个”stef”字符串还是由实参持有着的，所以，并没有修改到实际参数的值。<br><br><font color="#ff0040" size="3.5" face="Times New Roman"><br>所以说，Java中其实还是值传递的，只不过对于对象参数，值的内容是对象的引用。<br></font><br><p></p>

</div><div class="article-meta" style="max-width:800px"></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="cjloz7zm50006b4uc5av15ymj" data-title="Java中只有值传递" data-url="http://yoursite.com/2018/04/14/20180414/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2018/04/28/20180428/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2018/03/31/20180331/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/stef24" title="Github" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2018 rivers &amp; lakes<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>