<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>Java中的字符串被定义为不可变的 - rivers &amp; lakes</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/image/stef.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="/image/page_background.jpg"><div class="post-title"><h1 class="title">Java中的字符串被定义为不可变的</h1><ul class="meta"><li><i class="icon icon-author"></i>大米粥科技的小伙伴</li><li><i class="icon icon-clock"></i>1 Minutes</li><li><i class="icon icon-calendar"></i>March 3, 2018</li></ul></div></div><div class="article-content" style="max-width:800px"><p><br><font color="#ff0044" size="3.5" face="Times New Roman">Java中的字符串被定义为不可变的</font><br></p><br><font color="#000000" size="3.5" face="MV Boli">jiawei</font><br><a id="more"></a><br><br>字符串，通常我们在代码中有几种方式可以创建字符串，比如：String s = “stef”;<br>这时，其实会在堆内存中创建一个字符串对象，其中保存了一个字符数组，该数组中保存了字符串的内容。<br><br>当在代码中连续创建两个相同的字符串的时候，其实会指向同一个对象。因为当一个字符串被被创建的时候，首先会去这个字符串池中查找，如果找到，直接返回对该字符串的引用。<br>但是，如果在程序中明确声明要新创建一个字符串的话是可以在堆上重新创建一个对象的。如String s = new String(“stef”)<br><br>两个字符串中常用的操作：截取和连接会发生什么，是在原来的字符串对象上修改还是重新创建字符串呢?<br>字符串的连接。如String s1 = s.concat(“stef”);<br>字符串的截取。如String s1 = s.substring(0,2);<br><font color="#ff0044" size="3.0" face="Times New Roman"><br>字符串是不可变的，无论发生什么操作，一个已经创建好的字符串的内容不会被改变，对它的任何类似修改的操作其实都是新生成了一个字符串对象。<br></font><br><br><font color="#93C572" size="3.0" face="Times New Roman">缓存Hashcode</font><br>Java中经常会用到字符串的哈希码（hashcode）。例如，在HashMap中，字符串的不可变能保证其hashcode永远保持一致，这样就可以避免一些不必要的麻烦。这也就意味着每次在使用一个字符串的hashcode的时候不用重新计算一次，这样更加高效。<br>在String类中，有以下代码：private int hash;<br>以上代码中hash变量中就保存了一个String对象的hashcode，因为String类不可变，所以一旦对象被创建，该hash值也无法改变。所以，每次想要使用该对象的hashcode的时候，直接返回即可。<br><br>如果字符串可以被改变，那么以上用法将有可能违反Set的设计原则，因为Set要求其中的元素不可以重复。上面的代码只是为了简单说明该问题，其实String类中并没有value这个字段值。<br>安全性<br>String被广泛的使用在其他Java类中充当参数。比如网络连接、打开文件等操作。如果字符串可变，那么类似操作可能导致安全问题。因为某个方法在调用连接操作的时候，他认为会连接到某台机器，但是实际上并没有（其他引用同一String对象的值修改会导致该连接中的字符串内容被修改）。可变的字符串也可能导致反射的安全问题，因为他的参数也是字符串。<br><br><font color="#93C572" size="3.0" face="Times New Roman">不可变对象天生就是线程安全的</font><br>因为不可变对象不能被改变，所以他们可以自由地在多个线程之间共享。不需要任何同步处理。<br>总之，String被设计成不可变的主要目的是为了安全和高效。所以，使String是一个不可变类是一个很好的设计。<br><br><p></p>
</div><div class="article-meta" style="max-width:800px"></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="cjpjaoq490003ukuc8d8oie7x" data-title="Java中的字符串被定义为不可变的" data-url="http://yoursite.com/2018/03/03/20180303/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2018/03/17/20180317/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2018/02/14/20180214/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/stef24" title="Github" target="_blank"><i class="icon icon-github"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2018 rivers &amp; lakes<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small></p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>